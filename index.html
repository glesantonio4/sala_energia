<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MUCH Â· Quiz Interactivo</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <canvas id="confetti" class="confetti-canvas"></canvas>

  <!-- BotÃ³n â€œfantasmaâ€ por si app.js lo busca (evita errores) -->
  <button id="startBtn" class="visually-hidden" hidden></button>

  <!-- ğŸ” REDIRECCIÃ“N: si entras directo a index, te llevo a portada -->
  <script>
    (function () {
      var from = new URLSearchParams(location.search).get('from');
      // Permite entrar si vienes desde la portada; si no, manda a portada.html
      if (from !== 'portada') {
        location.replace('portada.html');
      }
    })();
  </script>

  <!-- ====== QUIZ ====== -->
  <main id="quizShell">
    <div class="quiz-card">

      <!-- HEADER: Logos + TÃ­tulo -->
      <div class="header-section text-center mb-3">
        <div class="d-flex justify-content-between align-items-center mb-2 px-1">
          <img src="Logo-Ag-14.png" alt="Gobierno de Chiapas" class="logo-header logo-left">
          <img src="logo-sata.png" alt="SATA" class="logo-header logo-right">
        </div>

        <h1 class="app-title mb-0">MUCH Â· Quiz Interactivo</h1>
        <p class="app-subtitle mb-0">Responde, aprende y Â¡gana tu entrada! ğŸ</p>
      </div>

      <!-- CONTROLS: Sala | Sound | Timer (Centered Row) -->
      <div class="controls-row d-flex justify-content-center align-items-center gap-3 mb-4">
        <div id="pillSala" class="sala-pill">Sala: EnergÃ­a</div>

        <div class="d-flex align-items-center gap-2 bg-light px-3 py-1 rounded-pill border">
          <div class="form-check form-switch mb-0 min-h-0">
            <input class="form-check-input" type="checkbox" id="soundToggle" checked>
          </div>
          <span id="timer" class="timer-text">â° 19:02</span>
        </div>
      </div>

      <!-- Barra de progreso visual (opcional, dejamos fina arriba) -->
      <div class="progress mb-4" style="height:4px;" role="progressbar">
        <div id="bar" class="progress-bar" style="width:0%"></div>
      </div>

      <section id="quizView">
        <div class="question-container text-center">

          <!-- Badge de Pregunta -->
          <div class="d-inline-block mb-3">
            <span class="badge-question">
              PREGUNTA <span id="qIndex">1</span> DE <span id="qTotal">6</span>
            </span>
          </div>

          <!-- Pregunta -->
          <h2 id="qText" class="question-text mb-4">Â¿...?</h2>
          <p id="qDesc" class="d-none">...</p> <!-- Descripcion oculta o sutil -->

          <!-- Opciones (Vertical) -->
          <div id="options" class="options-list d-flex flex-column gap-3 mb-4">
            <!-- Se llenan con JS -->
          </div>

          <div id="status" class="status-msg fw-bold mb-3" aria-live="polite"></div>

          <!-- BotÃ³n Siguiente -->
          <button id="nextBtn" type="button" class="btn btn-action w-100 py-3 rounded-4 fw-bold shadow-sm">
            Siguiente â¡ï¸
          </button>

        </div>

        <div class="footer-info text-center mt-4">
          <div class="points-pill">
            â­ Puntos: <strong id="points">0</strong>
          </div>
          <p id="hint" class="tiny text-muted mt-2 mb-0">Tip: solo puedes elegir una respuesta</p>
        </div>
      </section>

      <!-- VISTA FINAL (Resultados) -->
      <section id="finalView" class="d-none text-center py-4">
        <h2 id="finalTitle" class="h4 fw-bold mb-2">Resultados</h2>
        <p id="finalMsg" class="text-secondary mb-4"></p>

        <div class="result-score mb-4">
          <div class="display-4 fw-bold text-primary mb-0"><span id="finalPoints">0</span></div>
          <small class="text-uppercase tracking-wider">Puntos Totales</small>
        </div>

        <p class="mb-4">
          Aciertos: <strong id="finalCorrect">0</strong> de <strong id="finalTotal">0</strong>
        </p>

        <div id="giftRow" class="d-flex flex-column gap-2 d-none">
          <button id="openTicketBtn" class="btn btn-success w-100 py-3 rounded-4">ğŸŸï¸ Ver mi boleto</button>
          <button id="playAgainBtn1" class="btn btn-outline-secondary w-100 py-2 rounded-4">ğŸ” Jugar otra vez</button>
        </div>

        <div id="retryRow" class="d-flex flex-column gap-2 d-none">
          <button id="playAgainBtn2" class="btn btn-primary w-100 py-3 rounded-4">ğŸ” Intentar de nuevo</button>
        </div>
      </section>

    </div>
  </main>

  <!-- Bootstrap -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- LÃ³gica del quiz + conexiÃ³n a Supabase (vÃ­a import en app.js) -->
  <script src="app.js"></script>
</body>

</html>